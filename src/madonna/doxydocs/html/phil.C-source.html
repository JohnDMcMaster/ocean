<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<title>phil.C Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.1.5 on Thu Sep 28 15:38:01 2000 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>phil.C</h1><a href="phil.C.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">// ***************************************************************************</font>
00002 <font class="comment">// *  PHIL.C                                                                 *</font>
00003 <font class="comment">// *         Detailed placement in Sea Of Gates                              *</font>
00004 <font class="comment">// *                                                                         *</font>
00005 <font class="comment">// *  Author : Ireneusz Karkowski 1991                                       *</font>
00006 <font class="comment">// *    @(#)phil.C 1.20 09/01/99 Delft University of Technology </font>
00007 <font class="comment">// ***************************************************************************</font>
00008 <font class="preprocessor">#include &lt;iostream.h&gt;</font>
00009 <font class="preprocessor">#include &lt;stdlib.h&gt;</font>
00010 <font class="preprocessor">#include &lt;string.h&gt;</font>
00011 <font class="preprocessor">#include "<a class="code" href="plcm.h.html">plcm.h</a>"</font>
00012 <font class="preprocessor">#include "<a class="code" href="parserIf.h.html">parserIf.h</a>"</font>
00013 
<a name="l00014"></a><a class="code" href="phil.C.html#a4">00014</a> <a class="code" href="class_plcm.html">Plcm</a> *plcm;
<a name="l00015"></a><a class="code" href="phil.C.html#a5">00015</a> <a class="code" href="class_parserinterface.html">ParserInterface</a> parInt;         <font class="comment">// This object serves as an interface</font>
00016                 <font class="comment">// to "image.seadif" file parser.</font>
00017 
<a name="l00018"></a><a class="code" href="phil.C.html#a6">00018</a>   <font class="keyword">extern</font> <font class="keywordtype">int</font> phil_verbose;
<a name="l00019"></a><a class="code" href="phil.C.html#a7">00019</a>   <font class="keyword">extern</font> <font class="keywordtype">int</font> rand_points;
<a name="l00020"></a><a class="code" href="phil.C.html#a8">00020</a>   <font class="keyword">extern</font> <font class="keywordtype">int</font> doCompresion;
<a name="l00021"></a><a class="code" href="phil.C.html#a9">00021</a>   <font class="keyword">extern</font> <font class="keywordtype">int</font> set_srand;
<a name="l00022"></a><a class="code" href="phil.C.html#a10">00022</a>   <font class="keyword">extern</font> <font class="keywordtype">int</font> macroMinSize;
00023 
<a name="l00024"></a><a class="code" href="phil.C.html#a11">00024</a>   <font class="keyword">extern</font> <font class="keywordtype">int</font> slicingLayout;
<a name="l00025"></a><a class="code" href="phil.C.html#a12">00025</a>   <font class="keyword">extern</font> <font class="keywordtype">int</font> doTranAna;
<a name="l00026"></a><a class="code" href="phil.C.html#a13">00026</a>   <font class="keyword">extern</font> <font class="keywordtype">int</font> makeChannels;
00027 
<a name="l00028"></a><a class="code" href="phil.C.html#a14">00028</a> <font class="keyword">extern</font> <font class="keywordtype">int</font> requestedGridPoints[]; <font class="comment">// Here we keep initial size of the placement</font>
00029                   <font class="comment">// plane.</font>
<a name="l00030"></a><a class="code" href="phil.C.html#a15">00030</a> <font class="keyword">extern</font> <font class="keywordtype">int</font> expandableDirection;   <font class="comment">// How to increase its size.</font>
00031 
<a name="l00032"></a><a class="code" href="phil.C.html#a0">00032</a> <font class="preprocessor">#define  INC_FACT     1.3
</font>00033 <font class="preprocessor"></font>
00034 <font class="comment">//----------------------------------------------------------------------------</font>
00035 <font class="comment">//</font>
00036 <font class="comment">// Main routine of detailed placement.</font>
00037 <font class="comment">// </font>
00038 <font class="comment">// Assumes that :</font>
00039 <font class="comment">//     1. Seadif database is already opened </font>
00040 <font class="comment">//     2. Partitioned circuit is left in the memory - structure </font>
00041 <font class="comment">//            pointed by fromPartiotioner pointer.</font>
00042 <font class="comment">//</font>
00043 <font class="comment">// After calling it external call closing database is required.</font>
00044 <font class="comment">// </font>
<a name="l00045"></a><a class="code" href="phil.C.html#a0">00045</a> <font class="keywordtype">int</font>  <a class="code" href="phil_glob.h.html#a0">phil</a>(<font class="keywordtype">char</font> *cName,<font class="keywordtype">char</font> *fName,<font class="keywordtype">char</font> *lName,<font class="keywordtype">char</font> *oName,<font class="keywordtype">double</font> <font class="comment">/* magn */</font>,
00046                     CIRCUIT *fromPartitioner,
00047                     CIRCUIT *realCircuit,
00048                 <a class="code" href="class__global_routing.html">GLOBAL_ROUTING</a> *glob_rout)<font class="keyword">
</font>00049 <font class="keyword"></font>{
00050     
00051     cout &lt;&lt; <font class="stringliteral">"\n------ Detailed placement of ("</font> &lt;&lt; oName &lt;&lt; <font class="stringliteral">"("</font> &lt;&lt; cName 
00052          &lt;&lt; <font class="stringliteral">"("</font> &lt;&lt; fName &lt;&lt; <font class="stringliteral">"("</font> &lt;&lt; lName &lt;&lt; <font class="stringliteral">"))))...\n"</font>;
00053     
00054     <font class="keywordflow">if</font>(doTranAna&lt;0)
00055       doTranAna=0;
00056 
00057     <font class="keywordflow">if</font>( doTranAna==1)
00058     {
00059       slicingLayout=1;
00060       doTranAna=1;
00061       rand_points=1;
00062     }
00063 
00064     
00065     plcm = <font class="keyword">new</font> Plcm(cName,fName,lName,
00066                      parInt.<a class="code" href="class_parserinterface.html#a4">getImageDesc</a>(),
00067              parInt.<a class="code" href="class_parserinterface.html#a3">getImageMap</a>(),
00068              oName,
00069              fromPartitioner,
00070              (makeChannels==1?glob_rout:NULL),
00071              <a class="code" href="sea.h.html#a3">Boolean</a>(slicingLayout),
00072              <a class="code" href="sea.h.html#a3">Boolean</a>(doTranAna),
00073                      <a class="code" href="sea.h.html#a3">Boolean</a>(phil_verbose),
00074                      <a class="code" href="sea.h.html#a3">Boolean</a>(rand_points),set_srand,macroMinSize);
00075 
00076     cout &lt;&lt; <font class="stringliteral">"------ Reading input data"</font> &lt;&lt; endl;
00077     
00078     plcm-&gt; read();    
00079     
00080     cout &lt;&lt; <font class="stringliteral">"------ Creating temporary data structures"</font> &lt;&lt; endl;
00081     
00082     plcm-&gt;<a class="code" href="class_plcm.html#a3">prepare</a>();
00083     
00084     <font class="keywordtype">int</font> done;
00085 
00086     <font class="keywordflow">do</font>
00087     {
00088       cout &lt;&lt; <font class="stringliteral">"------ Placement plane size : ["</font> &lt;&lt; requestedGridPoints[HOR] &lt;&lt; <font class="stringliteral">":"</font> 
00089       &lt;&lt; requestedGridPoints[VER] &lt;&lt; <font class="stringliteral">"]"</font> &lt;&lt; endl;
00090 
00091       plcm-&gt;<a class="code" href="class_plcm.html#a4">createPlane</a>(requestedGridPoints[HOR],requestedGridPoints[VER]);
00092 
00093       cout &lt;&lt; <font class="stringliteral">"------ Doing placement "</font> &lt;&lt; endl;
00094 
00095       done = ! plcm-&gt;<a class="code" href="class_plcm.html#a5">placement</a>();
00096 
00097       <font class="keywordflow">if</font>(!done)         <font class="comment">// will have to increase the size of the placement</font>
00098       {             <font class="comment">// plane</font>
00099 
00100     <font class="keywordflow">if</font>(expandableDirection == HOR)
00101         requestedGridPoints[HOR]=int(INC_FACT*requestedGridPoints[HOR]);
00102       <font class="keywordflow">else</font>
00103         requestedGridPoints[VER]=int(INC_FACT*requestedGridPoints[VER]);        
00104     plcm-&gt;<a class="code" href="class_plcm.html#a7">recover</a>();
00105       }
00106     }<font class="keywordflow">while</font>(!done);
00107 
00108                 <font class="comment">// one small detail - let\'s properly set </font>
00109                 <font class="comment">// the bounding box (it may be smaller than</font>
00110                 <font class="comment">// placement plane size)</font>
00111 
00112     plcm-&gt;<a class="code" href="class_plcm.html#a6">setBbx</a>();
00113 
00114   
00115 
00116     <font class="keywordflow">if</font>(doCompresion&gt;0)
00117     {
00118       cout &lt;&lt; <font class="stringliteral">"------ Compacting  "</font> &lt;&lt; endl;    
00119       plcm-&gt;<a class="code" href="class_plcm.html#a8">compaction</a>();
00120 
00121     }
00122 
00123     <font class="keywordflow">if</font>(doTranAna)
00124     {
00125       cout &lt;&lt; <font class="stringliteral">"------ Transparencies Analysis. "</font> &lt;&lt; endl;
00126       plcm-&gt;<a class="code" href="class_plcm.html#a10">doTranspAnalysis</a>();
00127     }
00128 
00129 
00130 
00131 <font class="preprocessor">#ifdef __MSDOS__
</font>00132 <font class="preprocessor"></font>    fclose(stdprn);
00133     fclose(stdaux);
00134 <font class="preprocessor">#endif
</font>00135 <font class="preprocessor"></font><font class="comment">//    if(!doTranAna)        // it\'\' be passed to the global router</font>
00136     <font class="keywordflow">if</font> (1)
00137     {               <font class="comment">// so don\'t write it yet.</font>
00138       cout &lt;&lt; <font class="stringliteral">"------ Writing created layout to database"</font> &lt;&lt; endl;
00139       plcm-&gt;<a class="code" href="class_plcm.html#a9">write</a>(realCircuit);
00140     }
00141     <font class="keywordflow">else</font>
00142       plcm-&gt;<a class="code" href="class_plcm.html#a9">write</a>(realCircuit,<font class="keyword">false</font>); <font class="comment">// false == do not write</font>
00143 
00144     <font class="keyword">delete</font> plcm;
00145     
00146     <font class="keywordflow">return</font> 0;
00147 } 
00148 
00149 <font class="comment">//----------------------------------------------------------------------------</font>
<a name="l00150"></a><a class="code" href="phil.C.html#a1">00150</a>                <font class="keywordtype">void</font>  <a class="code" href="phil.C.html#a2">readImageFile</a>( <font class="keywordtype">void</font>  )
00151 <font class="comment">//</font>
00152 <font class="comment">// Read image file.</font>
00153 {
00154   parInt.<a class="code" href="class_parserinterface.html#a2">read</a>();
00155 
00156 }<font class="comment">// readImageFile  //</font>
00157 
00158 
00159 <font class="comment">//----------------------------------------------------------------------------</font>
<a name="l00160"></a><a class="code" href="phil.C.html#a2">00160</a>                <a class="code" href="class__imagedesc.html">IMAGEDESC</a>* <a class="code" href="phil.C.html#a3">getImageDesc</a>( <font class="keywordtype">void</font>  )
00161 <font class="comment">//</font>
00162 <font class="comment">//</font>
00163 {
00164   <font class="keywordflow">return</font> parInt.<a class="code" href="class_parserinterface.html#a4">getImageDesc</a>();
00165 
00166 }<font class="comment">// getImageDesc  //</font>
00167 
</div></pre><hr><address><small>Generated at Thu Sep 28 15:38:01 2000 for madonna by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align=center border=0 
width=110 height=53></a>1.1.5 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy; 1997-2000</small></address>
</body>
</html>
